<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <script src="d3.js"></script>

    <script src="d3.min.js"></script>
    <script src="d3-legend.min.js"></script>
    <script src="d3-legend.js"></script>
    <script src="FileSaver.js"></script>
    <script src="FileSaver.min.js"></script>
    <style>
      #tooltip {
        position: absolute;
        display: none;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 3px;
        box-shadow: -3px 3px 15px #939393;
        color: white;
        padding: 6px;
        font-family: "Merriweather";
        font-size: 1.1em;
        max-width: 400px;
        z-index: 100;
      }

      body {
        background-color: rgb(245, 244, 241);
        overflow-x: hidden;
      }

      #sections {
        position: relative;
        display: inline-block;
        width: 300px;
        top: 60px;
        z-index: 1;
        margin-right: 50px;
        opacity: 1;
      }

      #circlelegend {
        position: absolute;
        display: inline-block;
        width: 300px;
        height: 400px;
        top: 1400px;
        z-index: 99;
        margin-right: 50px;
        opacity: 1;
        fill: rgb(245, 244, 241);
      }

      #typelegend {
        position: absolute;
        display: inline-block;
        width: 300px;
        height: 400px;
        top: 2000px;
        z-index: 99;
        margin-right: 50px;
        opacity: 1;
        fill: rgb(245, 244, 241);
      }

      .categoryLegend {
        font-family: "Domine";
      }

      .step {
        margin-bottom: 100px;
        height: 150px;
        font-family: "Domine";
        font-weight: 400;
        line-height: 1.4em;
        text-align: justify;
        display: flex;
        flex-direction: column;
        justify-content: space-around;
      }

      h1,
      h2 {
        font-weight: 700;
        text-align: right;
        line-height: 32px;
      }

      h1 {
        font-size: 35px;
      }

      strong {
        color: rgb(245, 155, 155);
      }

      #graphic {
        margin: auto;
        width: 1500px;
        flex-direction: row;
        align-items: top;
        justify-content: space-around;
      }

      #vis {
        display: inline-block;
        position: fixed;
        top: 0px;
        z-index: 1;
        margin-left: 0;
        height: 1000px;
        width: 1500px;
      }

      .tick line {
        stroke: "red";
      }

      svg circle:hover {
        cursor: pointer;
      }

      .swatch {
        fill: #939393;
      }

      .sizeLegend2 {
        opacity: 0.7;
      }

      a {
        color: rgb(221, 0, 255);
        text-decoration: none;
      }

      img {
        display: none;
      }
      #video {
        position: absolute;
        left: 570px;
        top: 60px;
        z-index: 10;
        filter: opacity(80%);
      }
    </style>
  </head>
  <body>
    <div id="circlelegend"></div>
    <div id="typelegend"></div>
    <div id="tooltip"></div>
    <div id="video">
      <video id="video1" width="320" autoplay muted loop>
        <source src="video.mp4" />

        Your browser does not support HTML video.
      </video>
    </div>
    <div id="graphic">
      <div id="sections">
        <h1 style="text-align: center">Police Violence at US Protests</h1>
        INTRO. Aenean commodo nulla ac nisi gravida lobortis. Aliquam et
        pulvinar lacus. Vivamus non lectus vel augue fermentum tristique ut eget
        felis. Phasellus ac dolor urna. Sed vel egestas neque. Cras fermentum
        erat a sem pellentesque interdum. Integer sagittis ullamcorper nisi et
        bibendum. Ut gravida pharetra lorem commodo congue. Etiam vitae elit
        rutrum, ullamcorper dui a, tempor mauris. Fusce tristique interdum
        velit, non mattis augue eleifend sit amet. Curabitur fermentum neque non
        diam molestie, vitae lacinia diam tempus.

        <section class="step"></section>
        <h1 style="text-align: center">Total number of cases</h1>
        # of states, # of cities, other interesting things....Lorem ipsum dolor
        sit amet, consectetur adipiscing elit. Aenean commodo nulla ac nisi
        gravida lobortis. Aliquam et pulvinar lacus. Vivamus non lectus vel
        augue fermentum tristique ut eget felis. Phasellus ac dolor urna. Sed
        vel egestas neque. Cras fermentum erat a sem pellentesque interdum.
        Integer sagittis ullamcorper nisi et bibendum. Ut gravida pharetra lorem
        commodo congue. Etiam vitae elit rutrum, ullamcorper dui a, tempor
        mauris. Fusce tristique interdum velit, non mattis augue eleifend sit
        amet. Curabitur fermentum neque non diam molestie, vitae lacinia diam
        tempus.
        <section class="step"></section>
        <h1 style="text-align: center">
          Cases concentrated in Portland, New York, LA
        </h1>
        <h2 style="text-align: left">Top Five Cities</h2>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Portland,
        OR: 39 Cases<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;New York
        City, NY: 39 Cases<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Los Angeles,
        CA: 21 Cases<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Seattle, WA:
        15 Cases<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Washington
        D.C.: 13 Cases<br /><br />

        <section class="step"></section>
        <h1 style="text-align: center">Type of Violation Map</h1>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo
        nulla ac nisi gravida lobortis. Aliquam et pulvinar lacus.
        <br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Less Lethal
        Round<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Physical
        Assault<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tear Gas<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Arrest/Detention<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pepper
        Spray<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Intimidation<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Killing<br /><br />
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Other<br /><br />
        <section class="step"></section>
        <h1 style="text-align: center">Grouping of Violations</h1>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo
        nulla ac nisi gravida lobortis. Aliquam et pulvinar lacus. Vivamus non
        lectus vel augue fermentum tristique ut eget felis. Phasellus ac dolor
        urna. Sed vel egestas neque. Cras fermentum erat a sem pellentesque
        interdum. Integer sagittis ullamcorper nisi et bibendum. Ut gravida
        pharetra lorem commodo congue. Etiam vitae elit rutrum, ullamcorper dui
        a, tempor mauris. Fusce tristique interdum velit, non mattis augue
        eleifend sit amet. Curabitur fermentum neque non diam molestie, vitae
        lacinia diam tempus.
        <section class="step"></section>
        <h1 style="text-align: center">A Violent Month in Portland</h1>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo
        nulla ac nisi gravida lobortis. Aliquam et pulvinar lacus. Vivamus non
        interdum. Integer sagittis ullamcorper nisi et bibendum. Ut gravida
        pharetra lorem commodo congue. Etiam vitae elit rutrum, ullamcorper dui
        a, tempor mauris. Fusce tristique interdum velit, non mattis augue
        eleifend sit amet. Curabitur fermentum neque non diam molestie, vitae
        lacinia diam tempus.
        <section class="step"></section>
        <h1 style="text-align: center">Violations spread out throughout the month, concentrated on weekends</h1>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo
        nulla ac nisi gravida lobortis. Aliquam et pulvinar lacus. Vivamus non
        lectus vel augue fermentum tristique ut eget felis. Phasellus ac dolor
        urna. Sed vel egestas neque. Cras fermentum erat a sem pellentesque
        interdum. Integer sagittis ullamcorper nisi et bibendum. Ut gravida
        pharetra lorem commodo congue. Etiam vitae elit rutrum, ullamcorper dui
        a, tempor mauris. Fusce tristique interdum velit, non mattis augue
        eleifend sit amet. Curabitur fermentum neque non diam molestie, vitae
        lacinia diam tempus.
        <section class="step"></section>
        <h1 style="text-align: center">Violations occur in the city center, many on Southwest Main Street /h1>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo
        nulla ac nisi gravida lobortis.
        <section class="step"></section>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo
        nulla ac nisi gravida lobortis. Aliquam et pulvinar lacus. Vivamus non
        lectus vel augue fermentum tristique ut eget felis. Phasellus ac dolor
        urna. Sed vel egestas neque. Cras fermentum erat a sem pellentesque
        interdum. Integer sagittis ullamcorper nisi et bibendum. Ut gravida
        pharetra lorem commodo congue. Etiam vitae elit rutrum, ullamcorper dui
        a, tempor mauris. Fusce tristique interdum velit, non mattis augue
        eleifend sit amet. Curabitur fermentum neque non diam molestie, vitae
        lacinia diam tempus.
        <section class="step"></section>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean commodo
        nulla ac nisi gravida lobortis. Aliquam et pulvinar lacus. Vivamus non
        lectus vel augue fermentum tristique ut eget felis. Phasellus ac dolor
        urna. Sed vel egestas neque. Cras fermentum erat a sem pellentesque
        interdum. Integer sagittis ullamcorper nisi et bibendum. Ut gravida
        pharetra lorem commodo congue. Etiam vitae elit rutrum, ullamcorper dui
        a, tempor mauris. Fusce tristique interdum velit, non mattis augue
        eleifend sit amet. Curabitur fermentum neque non diam molestie, vitae
        lacinia diam tempus.
      </div>
      <div id="vis"></div>
    </div>

    <script>
  
      /// CREATE MAP AND MARGINS ///

      const w = 1100;
      const h = 1000;
      var projection = d3
        .geoMercator()
        .translate([w / 2 + 20, h / 2 - 200])
        .center([-95.3, 39.19])
        .scale(1000);
      var projection2 = d3
        .geoMercator()
        .translate([w / 2 + 20, h / 2 - 200])
        .center([-122.67216, 45.51855])
        .scale(2300000);

      path = d3.geoPath().projection(projection);
      path2 = d3.geoPath().projection(projection2);

      var dataset;

      var svg = d3
        .selectAll("#vis")
        .append("svg")
        .attr("width", w)
        .attr("height", h)
        .attr("opacity", 1);
      svg
      .append('g')
      .append('text')
      .attr('class','port_streets')
      .attr('transform', 'rotate(20 ' + -1350 + ' ' + (1900) + ')')
      .attr('font-family','Arial')
      .attr('font-size','.8em')
      .attr('opacity',0)
      .text('Hawthorne Bridge')
      svg
      .append('g')
      .append('text')
      .attr('class','port_streets')
      .attr('transform', 'rotate(20 ' + -1150 + ' ' + (1400) + ')')
      .attr('font-family','Arial')
      .attr('font-size','.8em')
      .attr('opacity',0)
      .text('Main St')
      svg
      .append('g')
      .append('text')
      .attr('class','port_streets')
      .attr('transform', 'rotate(20 ' + -600 + ' ' + (2000) + ')')
      .attr('font-family','Arial')
      .attr('font-size','.8em')
      .attr('opacity',0)
      .text('Morrison Bridge')

      svg
      .append('g')
      .append('text')
      .attr('class','port_streets')
      .attr('x',710)
      .attr('y',35)
      .attr('font-family','Arial')
      .attr('font-size','.75em')
      .attr('opacity',0)
      .text('Burnside Bridge')

            svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 10)
        .attr("width", 1001)
        .attr("height", 654)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 3)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 35)
        .attr("width", 1001)
        .attr("height", 1)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 119)
        .attr("width", 1001)
        .attr("height", 1)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 229)
        .attr("width", 1001)
        .attr("height", 1)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 339)
        .attr("width", 1001)
        .attr("height", 1)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 449)
        .attr("width", 1001)
        .attr("height", 1)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 559)
        .attr("width", 1001)
        .attr("height", 1)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 10)
        .attr("y", 449)
        .attr("width", 1001)
        .attr("height", 1)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 153)
        .attr("y", 10)
        .attr("width", 1)
        .attr("height", 654)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 296)
        .attr("y", 10)
        .attr("width", 1)
        .attr("height", 654)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 439)
        .attr("y", 10)
        .attr("width", 1)
        .attr("height", 654)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 582)
        .attr("y", 10)
        .attr("width", 1)
        .attr("height", 654)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 725)
        .attr("y", 10)
        .attr("width", 1)
        .attr("height", 654)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);
      svg
        .append("rect")
        .attr("class", "cal")
        .attr("x", 868)
        .attr("y", 10)
        .attr("width", 1)
        .attr("height", 654)
        .attr("rx", 0)
        .attr("ry", 0)
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("fill-opacity", 0)
        .attr("opacity", 0);

      d3.json("us-states.geojson").then(function (data) {
        svg
          .selectAll("path")
          .data(data.features)
          .enter()
          .append("path")
          .attr("id", "main")
          .attr("d", path)
          .attr("opacity", 0.5)
          .attr("fill", "#D6D6D6")
          .attr("stroke", "black");
      });
      d3.csv("police_clean5.csv").then(function (data) {
        var parseTime = d3.timeParse("%d/%m/%Y");
        data.forEach(function (d) {
          d.date = parseTime(d.date);
          d.x = +projection([+d.Longitude, +d.Latitude])[0];
          d.y = +projection([+d.Longitude, +d.Latitude])[1];
          dataset1 = data;
          svg
            .selectAll("circle")
            
            .data(data)
            .enter()
            .append("circle")
            .attr("id", "dataAnim")
            .attr("class", function (d) {
              return "date" + d.index;
            })
            .attr("cx", function (d) {
              return projection([+d.Longitude, +d.Latitude])[0];
            })
            .attr("cy", function (d) {
              return projection([+d.Longitude, +d.Latitude])[1];
            })
            .attr("fill", "red")
            .attr("r", 15)
            .attr("stroke", "yellow")
            .attr("stroke-width", 4)
            .attr("opacity", 0);
        });

        svg
          .append("text")
          .attr("class", "title")
          .attr("x", w - 400)
          .attr("y", 60)
          .attr("font-family", "monospace")
          .attr("font-size", "2.5em")
          .attr("font-weight", 700)
          .attr("opacity", 0)
          .text("HELLO");
          
          d3.json("comb_v2.geojson").then(function (data) {
          json = data;
          svg
            .append("g")
            .selectAll("path")
            .data(data.features)
            .enter()
            .append("path")
            .attr("id", "port")
            .attr("d", path2)
            .attr("opacity", 0)
            .attr("fill", function (d) {
              if (d.properties.fclass === "building") {
                return "#f2eee9";
              }
              if (d.properties.fclass === "water") {
                return "#aad3df";
              }
              if (d.properties.fclass === "park") {
                return "#c8facc";
              }
              if (d.properties.fclass === "primary") {
                return "#fcd6a4";
              }
              if (d.properties.fclass === "secondary") {
                return "#f7fabf";
              }
              if (d.properties.fclass === "tertiary") {
                return "#f9f2ce";
              } else {
                return "white";
              }
            })
            .attr("stroke", function (d) {
              if (d.properties.fclass === "building") {
                return "black";
              }
              if (d.properties.fclass === "water") {
                return "#aad3df";
              }
              if (d.properties.fclass === "park") {
                return "#c8facc";
              }
              if (d.properties.fclass === "primary") {
                return "#fcd6a4";
              }
              if (d.properties.fclass === "secondary") {
                return "#f7fabf";
              }
              if (d.properties.fclass === "tertiary") {
                return "#f9f2ce";
              } else {
                return "white";
              }
            })
            .attr("stroke-width", function (d) {
              if (d.properties.fclass === "building") {
                return 0.2;
              }
              if (d.properties.fclass === "water") {
                return 0.2;
              }
              if (d.properties.fclass === "park") {
                return 0.5;
              }
              if (d.properties.fclass === "primary") {
                return 3;
              }
              if (d.properties.fclass === "secondary") {
                return 2;
              }
              if (d.properties.fclass === "tertiary") {
                return 1;
              } else {
                return "white";
              }
            });
        });
        var circleleg = d3
          .select("#circlelegend")
          .append("svg")
          .attr("height", 300)
          .attr("width", 300)
          .attr("opacity", 1);

        circleleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg1")
          .attr("cx", 20)
          .attr("cy", 62)

          .attr("r", 10)
          .attr("stroke", "black");

        circleleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg2")
          .attr("cx", 20)
          .attr("cy", 98)

          .attr("r", 10)
          .attr("stroke", "black");

        circleleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg3")
          .attr("cx", 20)
          .attr("cy", 134)

          .attr("r", 10)
          .attr("stroke", "black");

        circleleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg4")
          .attr("cx", 20)
          .attr("cy", 170)

          .attr("r", 10)
          .attr("stroke", "black");

        circleleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg5")
          .attr("cx", 20)
          .attr("cy", 206)

          .attr("r", 10)
          .attr("stroke", "black");

        var typeleg = d3
          .select("#typelegend")
          .append("svg")
          .attr("height", 400)
          .attr("width", 400)
          .attr("opacity", 1);

        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg1")
          .attr("cx", 20)
          .attr("cy", 62)

          .attr("r", 10)
          .attr("stroke", "black");

        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg2")
          .attr("cx", 20)
          .attr("cy", 98)

          .attr("r", 10)
          .attr("stroke", "black");

        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg3")
          .attr("cx", 20)
          .attr("cy", 134)

          .attr("r", 10)
          .attr("stroke", "black");

        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg4")
          .attr("cx", 20)
          .attr("cy", 170)

          .attr("r", 10)
          .attr("stroke", "black");

        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg5")
          .attr("cx", 20)
          .attr("cy", 206)

          .attr("r", 10)
          .attr("stroke", "black");
        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg6")
          .attr("cx", 20)
          .attr("cy", 242)

          .attr("r", 10)
          .attr("stroke", "black");
        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg7")
          .attr("cx", 20)
          .attr("cy", 278)

          .attr("r", 10)
          .attr("stroke", "black");
        typeleg
          .append("circle")
          .attr("id", "circleleg")
          .attr("class", "leg8")
          .attr("cx", 20)
          .attr("cy", 314)
          .attr("r", 10)
          .attr("stroke", "black");
        window.onload = circleAnim();

        function circleAnim() {
          for (let yes = 0; yes < dataset1.length; yes++) {
            setTimeout(
              function () {
                if (activeIndex === 0) {
                  d3.selectAll("#dataAnim.date" + String(yes))
                    .raise()
                    .transition()
                    .attr("opacity", 0)
                    .transition()
                    .duration(500)
                    .attr("opacity", 1)
                    .attr("r", 15)
                    .attr("stroke", "yellow")
                    .attr("stroke-width", 3)
                    .transition()
                    .duration(500)
                    .attr("r", 5)
                    .attr("stroke", "black")
                    .attr("stroke-width", 1);
                  d3.selectAll(".title")
                    .transition()
                    .attr("opacity", 1)
                    .text(
                      String(dataset1[yes].date).replace(
                        "00:00:00 GMT+0200 (Central European Summer Time)",
                        ""
                      )
                    );
                } else {
                  d3.selectAll("#dataAnim").remove();
                  d3.selectAll(".title").remove();
                }
              },

              50 * yes
            );
          }
        }
      });

      function draw1() {
        d3.select("#vis").selectAll("#main").transition().attr("opacity", 0.5);

        if (typeof simulation !== "undefined") {
          simulation.stop();
        }

        d3.selectAll("#datacircle")
          .transition()
          .attr("opacity", 1)
          .attr("r", 5)
          .attr("stroke-width", 1)
          .attr("stroke", "black")
          .attr("cx", function (d) {
            return projection([+d.Longitude, +d.Latitude])[0];
          })
          .attr("cy", function (d) {
            return projection([+d.Longitude, +d.Latitude])[1];
          });

        d3.selectAll(".title1")
          .transition()
          .attr("x", w - 500)
          .attr("y", 60)
          .attr("font-family", "monospace")
          .attr("font-size", "2.5em")
          .attr("opacity", 1)
          .text("May 29 - July 10, 2020");
        i = 0;
        d3.selectAll(".label").transition().attr("opacity", 0);
      }

      function draw2() {
        d3.selectAll("#dataAnim").remove();
        d3.selectAll(".title").remove();

        
        var dow = [
          "Monday",
          "Tuesday",
          "Wednesday",
          "Thursday",
          "Friday",
          "Saturday",
          "Sunday",
        ];
        svg
          .append("text")
          .attr("class", "calLabel")
          .attr("x", 50)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .text(dow[0]);

        svg

          .append("text")
          .attr("class", "calLabel")
          .attr("x", 195)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .text(dow[1]);
        svg

          .append("text")
          .attr("class", "calLabel")
          .attr("x", 340)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .text(dow[2]);
        svg
          .append("text")
          .attr("class", "calLabel")
          .attr("x", 485)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .text(dow[3]);
        svg

          .append("text")
          .attr("class", "calLabel")
          .attr("x", 630)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .text(dow[4]);
        svg

          .append("text")
          .attr("class", "calLabel")
          .attr("x", 775)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .text(dow[5]);
        svg

          .append("text")
          .attr("class", "calLabel")
          .attr("x", 920)
          .attr("y", 30)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .text(dow[6]);
        svg

          .append("text")
          .attr("class", "calLabel1")
          .attr("x", 38)
          .attr("y", 55)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .attr("font-weight", 700)
          .attr("font-size", "1.8em")
          .text("June");
        svg

          .append("text")
          .attr("class", "calLabel1")
          .attr("x", 690 - 365)
          .attr("y", 470)
          .attr("text-anchor", "middle")
          .attr("opacity", 0)
          .attr("font-weight", 700)
          .attr("font-size", "1.8em")
          .text("July");

        for (let i = 0; i < 45; i++) {
          svg
            .append("text")
            .attr("class", "numLabel")
            .attr("x", function () {
              if (i / 7 <= 1) {
                return i * 142;
              }
              if (i / 7 <= 2) {
                return (i - 7) * 142;
              }
              if (i / 7 <= 3) {
                return (i - 14) * 142;
              }
              if (i / 7 <= 4) {
                return (i - 21) * 142;
              }
              if (i / 7 <= 5) {
                return (i - 28) * 142;
              }
              if (i / 7 <= 6) {
                return (i - 35) * 142;
              }
            })
            .attr("y", function () {
              if (i / 7 <= 1) {
                return 110;
              }
              if (i / 7 <= 2) {
                return 220;
              }
              if (i / 7 <= 3) {
                return 330;
              }
              if (i / 7 <= 4) {
                return 440;
              }
              if (i / 7 <= 5) {
                return 550;
              }
              if (i / 7 <= 6) {
                return 660;
              }
            })
            .attr("opacity", 0)
            .attr("text-anchor", "middle")
            .text(function () {
              if (i <= 30) {
                return i;
              } else {
                return i - 30;
              }
            });
        }
        svg
          .append("text")
          .attr("class", "title1")
          .attr("x", w - 400)
          .attr("y", 60)
          .attr("font-family", "monospace")
          .attr("font-size", "2.5em")
          .attr("font-weight", 700)
          .attr("opacity", 0)
          .text("HELLO");
        d3.csv("police_clean9.csv").then(function (data) {
          var parseTime = d3.timeParse("%d/%m/%Y");
          data.forEach(function (d) {
            d.date = parseTime(d.date);
            d.x = +projection([+d.Longitude, +d.Latitude])[0];
            d.y = +projection([+d.Longitude, +d.Latitude])[1];
            dataset = data;
            svg
              .selectAll("circle")
              .data(data)
              .enter()
              .append("circle")
              .attr("id", "datacircle")
              .attr("cx", function (d) {
                return projection([+d.Longitude, +d.Latitude])[0];
              })
              .attr("cy", function (d) {
                return projection([+d.Longitude, +d.Latitude])[1];
              })
              .attr("fill", "red")
              .attr("r", 15)
              .attr("stroke", "yellow")
              .attr("stroke-width", 4)
              .attr("opacity", 1)
              .transition()
              .attr("r", 5)
              .attr("stroke", "black")
              .attr("stroke-width", 1)
              ;
          });
        });

        d3.selectAll("#datacircle")
          .transition()
          .attr("opacity", 1)
          .attr("r", 5)
          .attr("stroke", "black")
          .attr("stroke-width", 1)
          .attr("cx", function (d) {
            return projection([+d.Longitude, +d.Latitude])[0];
          })
          .attr("cy", function (d) {
            return projection([+d.Longitude, +d.Latitude])[1];
          })
          .attr("fill", "red");

        d3.select("#vis")
          .selectAll(".title1")
          .transition()
          .attr("opacity", 1)
          .attr("font-size", "2em")
          .attr("x", w - 500)
          .attr("font-weight", 700)
          .text("349 Cases, 34 States, 97 Cities");

        d3.selectAll(".label").transition().attr("opacity", 0);


      }
      function draw3() {
        svg
          .selectAll("#datacircle")
          .raise()
          .on("mouseover", mouseOver)
          .on("mouseout", mouseOut)
          .on("click", click);

        function mouseOver(d, i) {
          var time = d3.timeFormat("%B %d, %Y");
          console.log("hi");
          d3.select(this)
            .transition("mouseover")
            .duration(0)
            .attr("stroke-width", 5)
            .attr("stroke", "yellow");

          d3
            .select("#tooltip")
            .style("left", d3.event.pageX + 10 + "px")
            .style("top", d3.event.pageY - 25 + "px")
            .style("display", "inline-block")
            .html(`<strong>Date:</strong> ${time(d.date)}
                        <br> <strong>City</strong> ${d.City}
                        <br> <strong>Type of Violation:</strong> ${
                          d["Type of Violation"]
                        }
                        `);
        }

        function mouseOut(d, i) {
          d3.select("#tooltip").style("display", "none");

          d3.select(this)
            .transition("mouseout")
            .duration(0)
            .attr("stroke-width", 1)
            .attr("stroke", "black");
        }

        function click(d, i) {
          var win = window.open(d.Hyperlink, "_blank");
          win.focus();
        }
        d3.selectAll(".label").transition().attr("opacity", 0);
        d3.select("#vis").selectAll("#main").transition().attr("opacity", 0.5);
        if (typeof simulation !== "undefined") {
          simulation.stop();
        }
        d3.selectAll(".label").transition().attr("opacity", 0);
        d3.select("#vis").selectAll(".title1").transition().attr("opacity", 0);

        d3.select("#vis").selectAll("#main").transition().attr("opacity", 0.5);

        hex = [
          "#000000",
          "#0086ED",
          "#3B5DFF",
          "#FF8A9A",
          "#0089A3",
          "#C0B9B2",
          "#201625",
          "#FF34FF",
          "#7A87A1",
          "#7A4900",
          "#008941",
          "#FF90C9",
          "#000035",
          "#788D66",
          "#A3C8C9",
          "#FF4A46",
          "#8CD0FF",
          "#4A3B53",
          "#456D75",
          "#FF913F",
          "#B79762",
          "#BC23FF",
          "#00489C",
          "#8FB0FF",
          "#0AA6D8",
          "#1B4400",
          "#997D87",
          "#549E79",
          "#FFAA92",
          "#A30059",
          "#D16100",
          "#00C2A0",
          "#4FC601",
          "#C8A1A1",
          "#6B002C",
          "#99ADC0",
          "#9B9700",
          "#6F0062",
          "#0000A6",
          "#FFF69F",
          "#34362D",
          "#452C2C",
          "#456648",
          "#BEC459",
          "#006FA6",
          "#B4A8BD",
          "#C2FF99",
          "#FFFF00",
          "#A05837",
          "#FFDBE5",
          "#B05B6F",
          "#772600",
          "#FDE8DC",
          "#636375",
          "#FF2F80",
          "#809693",
          "#D157A0",
          "#1CE6FF",
          "#CC0744",
          "#575329",
          "#7B4F4B",
          "#A1C299",
          "#013349",
          "#63FFAC",
          "#B77B68",
          "#B903AA",
          "#D790FF",
          "#922329",
          "#00846F",
          "#1E6E00",
          "#A77500",
          "#885578",
          "#004D43",
          "#5A0007",
          "#72418F",
          "#6367A9",
          "#001E09",
          "#938A81",
          "#886F4C",
          "#0CBD66",
          "#A079BF",
          "#6B7900",
          "#404E55",
          "#FAD09F",
          "#3B9700",
          "#BA0900",
          "#FFB500",
          "#00A6AA",
          "#7900D7",
          "#FEFFE6",
          "#EEC3FF",
          "#3A2465",
          "#04F757",
          "#300018",
          "#372101",
          "#61615A",
          "#00FECF",
          "#DDEFFF",
          "#C2FFED",
          "#5B4534",
        ];

        color = d3.scaleOrdinal().domain([0, 97]).range(hex);


        d3.selectAll("#main").transition().attr("opacity", 0.5);

        d3.selectAll("#datacircle")
        .transition()
        .duration(500)
          .attr("fill", function (d) {
            return color(d.cluster);
          })
          .attr("r", 9)
          .attr('cx',function(d){
            return d.x1
          })
          .attr('cy',function(d){
            return d.y1
          })
    
setTimeout(function(){
          d3.select(".leg1")
          .transition()
          .attr("fill", function () {
            return d3
              .selectAll("#datacircle")
              .filter(function (d) {
                return d.City === "Portland, OR, USA";
              })
              .attr("fill");
          });

        d3.select(".leg2")
          .transition()
          .attr("fill", function () {
            return d3
              .selectAll("#datacircle")
              .filter(function (d) {
                return d.City === "New York City, NY, USA";
              })
              .attr("fill");
          });

        d3.select(".leg3")
          .transition()
          .attr("fill", function () {
            return d3
              .selectAll("#datacircle")
              .filter(function (d) {
                return d.City === "Los Angeles, CA, USA";
              })
              .attr("fill");
          });

        d3.select(".leg4")
          .transition()
          .attr("fill", function () {
            return d3
              .selectAll("#datacircle")
              .filter(function (d) {
                return d.City === "Seattle, WA, USA";
              })
              .attr("fill");
          });

        d3.select(".leg5")
          .transition()
          .attr("fill", function () {
            return d3
              .selectAll("#datacircle")
              .filter(function (d) {
                return d.City === "Washington D.C., USA";
              })
              .attr("fill");
          });},501)
          

      
          d3.selectAll(".label").transition().attr("opacity", 0);


      }
     
     
      function draw4() {
        d3.selectAll(".label").transition().attr("opacity", 0);

        d3.select("#vis").selectAll("#main").transition().attr("opacity", 0.5);

        violationcolor = d3
          .scaleOrdinal()
          .domain([
            "Pepper Spray",
            "Physical Assault",
            "Less Lethal Round",
            "Tear Gas",
            "Other",
            "Intimidation",
            "Arrest/Detention",
            "Killing",
          ])
          .range(d3.schemeSet3);

        d3.selectAll("#datacircle")
          .transition()
          .ease(d3.easeLinear)
          .attr("cx", function (d) {
            return d.x1;
          })
          .attr("cy", function (d) {
            return d.y1;
          })
          .attr("fill", function (d) {
            return violationcolor(d["Type of Violation"]);
          });

        setTimeout(function () {
          d3.selectAll("#typelegend")
            .select(".leg1")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Less Lethal Round";
                })
                .attr("fill");
            });

          d3.selectAll("#typelegend")
            .select(".leg2")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Physical Assault";
                })
                .attr("fill");
            });

          d3.selectAll("#typelegend")
            .select(".leg3")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Tear Gas";
                })
                .attr("fill");
            });

          d3.selectAll("#typelegend")
            .select(".leg4")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Arrest/Detention";
                })
                .attr("fill");
            });

          d3.selectAll("#typelegend")
            .select(".leg5")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Pepper Spray";
                })
                .attr("fill");
            });

          d3.selectAll("#typelegend")
            .select(".leg6")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Intimidation";
                })
                .attr("fill");
            });

          d3.selectAll("#typelegend")
            .select(".leg7")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Killing";
                })
                .attr("fill");
            });

          d3.selectAll("#typelegend")
            .select(".leg8")
            .transition()
            .attr("fill", function () {
              return d3
                .selectAll("#datacircle")
                .filter(function (d) {
                  return d["Type of Violation"] === "Other";
                })
                .attr("fill");
            });
        }, 300);
      }

      function draw5() {
        d3.selectAll('#datacircle').transition().duration(700).attr('cx', function(d){return d.x2}).attr('cy', function(d){return d.y2})
        d3.selectAll(".numLabel").transition().attr("opacity", 0);
        d3.selectAll(".cal").transition().attr("opacity", 0);
        d3.selectAll(".calLabel").transition().attr("opacity", 0);
        d3.selectAll(".calLabel1").transition().attr("opacity", 0);
        
        svg
          .append("text")
          .attr("id", "l1")
          .attr("class", "label")
          .attr("x", 110)
          .attr("y", 320)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Less Lethal Round: 71");

        svg
          .append("text")
          .attr("id", "l2")
          .attr("class", "label")
          .attr("x", 400)
          .attr("y", 320)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Physical Assault: 66");
        svg
          .append("text")
          .attr("id", "l3")
          .attr("class", "label")
          .attr("x", 700)
          .attr("y", 320)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Tear Gas: 53");

        svg
          .append("text")
          .attr("id", "l4")
          .attr("class", "label")
          .attr("x", 1000)
          .attr("y", 320)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Arrest/Detention: 51");

        svg
          .append("text")
          .attr("id", "l5")
          .attr("class", "label")
          .attr("x", 100)
          .attr("y", 600)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Pepper Spray: 42");

        svg
          .append("text")
          .attr("id", "l6")
          .attr("class", "label")
          .attr("x", 400)
          .attr("y", 600)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Intimidation: 30");
        svg
          .append("text")
          .attr("id", "l7")
          .attr("class", "label")
          .attr("x", 700)
          .attr("y", 600)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Killing: 1");

        svg
          .append("text")
          .attr("id", "l8")
          .attr("class", "label")
          .attr("x", 1000)
          .attr("y", 600)
          .attr("font-family", "monospace")
          .attr("font-size", "1.1em")
          .attr("opacity", 0)
          .attr("text-anchor", "middle")
          .attr("font-weight", 700)
          .text("Other: 35");

        d3.selectAll("#datacircle").attr("opacity", 1);

        d3.selectAll("#l1").transition().text("Less Lethal Round: 71");

        d3.selectAll("#l2").transition().text("Physical Assault: 66");

        d3.selectAll("#l3").transition().text("Tear Gas: 53");

        d3.selectAll("#l4").transition().text("Arrest/Detention: 51");

        d3.selectAll("#l5").transition().text("Pepper Spray: 42");

        d3.selectAll("#l6").transition().text("Intimidation: 30");

        d3.selectAll("#l7").transition().text("Killing: 1");

        d3.selectAll("#l8").transition().text("Other: 1");

        d3.selectAll(".label").attr("opacity", 1);

        d3.select("#vis").selectAll("#main").transition().attr("opacity", 0);

        }
    

      
      

      function draw6() {
     
        d3.selectAll("#l1")
          .transition()

          .text("Less Lethal Round: 10");

        d3.selectAll("#l2")
          .transition()

          .text("Physical Assault: 2");

        d3.selectAll("#l3")
          .transition()

          .text("Tear Gas: 8");

        d3.selectAll("#l4")
          .transition()

          .text("Arrest/Detention: 4");

        d3.selectAll("#l5")
          .transition()

          .text("Pepper Spray: 1");

        d3.selectAll("#l6")
          .transition()

          .text("Intimidation: 10");

        d3.selectAll("#l7")
          .transition()

          .text("Killing: 0");

        d3.selectAll("#l8")
          .transition()

          .text("Other: 4");

        d3.selectAll("#datacircle")
          .transition()
          .attr("opacity", function (d) {
            if (d.City !== "Portland, OR, USA") {
              return 0.08;
            }
          });
         
      }

      function draw7() {
        d3.selectAll('.port_streets').raise().transition().attr('opacity',0)
        d3.selectAll('#datacircle')
        .transition()
        .duration(1000)
        .attr('cx',function(d){return d.x3})
        .attr('cy',function(d){return d.y3})
        
        d3.selectAll("#port").transition().attr("opacity", 0);
        d3.selectAll(".numLabel").transition().attr("opacity", 1);
        d3.selectAll(".cal").transition().attr("opacity", 1);
        d3.selectAll(".label").transition().attr("opacity", 0);
        d3.selectAll(".calLabel")
          .transition()
          .attr("opacity", 1)
          .attr("font-family", "monospace")
          .attr("font-size", "1.2em");
        d3.selectAll(".calLabel1")
          .transition()
          .attr("opacity", 1)
          .attr("font-family", "monospace");
        
         

      }

      function draw8() {
        d3.selectAll('.port_streets').raise().transition().attr('opacity',1)
        d3.selectAll("#datacircle")
          .raise()
          .transition()
          .delay(50)
          .duration(1000)
          .attr("cx", function (d) {
            return projection2([+d.Longitude, +d.Latitude])[0];
          })
          .attr("cy", function (d) {
            return projection2([+d.Longitude, +d.Latitude])[1];
          });
        d3.selectAll(".numLabel").transition().attr("opacity", 0);
        d3.selectAll(".cal").transition().attr("opacity", 0);
        d3.selectAll(".calLabel").transition().attr("opacity", 0);
        d3.selectAll(".calLabel1").transition().attr("opacity", 0);
        d3.selectAll("#port")

          .transition()
          .attr("opacity", function (d) {
            if (d.properties.fclass === "building") {
              return 1;
            }
            if (d.properties.fclass === "water") {
              return 0.3;
            }
            if (d.properties.fclass === "park") {
              return 0.8;
            }
            if (d.properties.fclass === "primary") {
              return 1;
            }
            if (d.properties.fclass === "secondary") {
              return 1;
            }
            if (d.properties.fclass === "tertiary") {
              return 1;
            } else {
              return 0;
            }
          });
         
      }

      let activationFunctions = [
        draw1,
        draw2,
        draw3,
        draw4,
        draw5,
        draw6,
        draw7,
        draw8,
      ];

      ///SCOLLER!@#!@#@!#!@#@!#

      let scroll = scroller().container(d3.select("#graphic"));
      scroll();

      let lastIndex,
        activeIndex = 0;

      scroll.on("active", function (index) {
        d3.selectAll(".step")
          .transition()
          .duration(500)
          .attr("opacity", function (d, i) {
            return i === index ? 1 : 0.1;
          });

        activeIndex = index;
        let sign = activeIndex - lastIndex < 0 ? -1 : 1;
        let scrolledSections = d3.range(
          lastIndex + sign,
          activeIndex + sign,
          sign
        );
        scrolledSections.forEach((i) => {
          activationFunctions[i]();
        });
        lastIndex = activeIndex;
      });

      scroll.on("progress", function (index, progress) {
        if ((index == 2) & (progress > 0.7)) {
        }
      });

      function scroller() {
        let container = d3.select("body");
        let dispatch = d3.dispatch("active", "progress");
        let sections = d3.selectAll(".step");
        let sectionPositions;

        let currentIndex = -1;
        let containerStart = 0;

        function scroll() {
          d3.select(window)
            .on("scroll.scroller", position)
            .on("resize.scroller", resize);

          resize();

          let timer = d3.timer(function () {
            position();
            timer.stop();
          });
        }

        function resize() {
          sectionPositions = [];
          let startPos;

          sections.each(function (d, i) {
            let top = this.getBoundingClientRect().top;

            if (i === 0) {
              startPos = top;
            }
            sectionPositions.push(top - startPos);
          });
        }

        function position() {
          let pos = window.pageYOffset - 300 - containerStart;
          let sectionIndex = d3.bisect(sectionPositions, pos);
          sectionIndex = Math.min(sections.size() - 1, sectionIndex);

          if (currentIndex !== sectionIndex) {
            dispatch.call("active", this, sectionIndex);
            currentIndex = sectionIndex;
          }

          let prevIndex = Math.max(sectionIndex - 1, 0);
          let prevTop = sectionPositions[prevIndex];
          let progress =
            (pos - prevTop) / (sectionPositions[sectionIndex] - prevTop);
          dispatch.call("progress", this, currentIndex, progress);
        }

        scroll.container = function (value) {
          if (arguments.legth === 0) {
            return container;
          }
          container = value;
          return scroll;
        };

        scroll.on = function (action, callback) {
          dispatch.on(action, callback);
        };

        return scroll;
      }
    </script>
  </body>
</html>
